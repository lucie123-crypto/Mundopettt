<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard - Cl√≠nica Veterin√°ria</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&display=swap" rel="stylesheet">
    
  <script src="script.js"></script>
  <script src="script2.js"></script>
  
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f3f4f6;
      display: flex;
    }
    .sidebar {
      width: 250px;
      background-color: #065e5f;
      color: white;
      height: 100vh;
      padding: 20px;
      position: fixed;
    }
    .sidebar h2 {
      font-size: 1.5rem;
      margin-bottom: 20px;
    }
    .sidebar a {
      display: block;
      padding: 10px 0;
      color: white;
      text-decoration: none;
      font-weight: 500;
      cursor: pointer;
    }
    .sidebar a:hover {
      background-color: #098b8d;
      padding-left: 10px;
      transition: all 0.3s ease;
    }
    .main {
      margin-left: 250px;
      padding: 40px;
      flex: 1;
    }
    .card {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .card h3 {
      font-size: 1rem;
      color: #4b5563;
      margin-bottom: 10px;
    }
    .card p {
      font-size: 2rem;
      font-weight: bold;
      color: #065e5f;
    }

    /* Se√ß√µes escondidas */
    .section {
      display: none;
    }
    /* Se√ß√£o ativa */
    .section.active {
      display: block;
    }
          .cards-pequenos {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 15px;
  margin-top: 20px;
}

.cards-pequenos .card-pequeno {
  background: white;
  border-radius: 8px;
  padding: 15px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
  font-size: 0.9rem;
  overflow-wrap: break-word;
}
.sidebar {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: 100vh; /* ocupa a altura total da tela */
  padding: 20px;
  background-color: #0f5858; /* ou a cor que estiver usando */
}

.voltar-site {
  margin-top: auto;
  padding: 10px;
  color: white;
  text-align: center;
  border-radius: 5px;
  text-decoration: none;
  transition: background 0.3s;
}

.voltar-site:hover {
  background-color: #0b7e7e;
}
.logodasboard {
  height: 200px;
  margin-top: -60px;
}
#welcomeMessage {
   font-family: "Oswald", sans-serif;
  font-size: 34px;
  color: #000000;
  font-weight: bold;
  margin: 20px 0; /* 20px em cima e embaixo, 0 nas laterais */
}
.user-name {
  color: #0b7e7e;
  font-weight: bold; /* opcional, deixa em negrito */
}

  </style>
</head>
<body>
<div class="sidebar">
  <img class="logodasboard" src="img/logodasboard.png" alt="">
  <a href="#dashboard">üìä Dashboard</a>
  <a href="#contatos">üì® Contatos</a>
  <a href="#consultas">üìÖ Consultas</a>
  <a href="#curriculos">üìÅ Curr√≠culos</a>
  <a href="#admins">üë§ Admins</a>
  <a href="#Cadastrar">‚öôÔ∏è Cadastrar Admin</a>
  <a href="Inicio.html" id="voltarsite" class="voltar-site">üîô Voltar para o site</a>
</div>
<div class="main">
  <section id="dashboard" class="section active">
          <header class="top-bar">
            <span id="welcomeMessage"></span>
          </header>
      <div class="grid">
        <div class="card"><h3>Contatos</h3><p id="totalcontato">0</p></div>
        <div class="card"><h3>Consultas</h3><p id="totalConsultas">0</p></div>
        <div class="card"><h3>Curr√≠culos</h3><p id="totalCurriculos">3</p></div>
        <div class="card"><h3>Admins</h3><p id="totalusers">0</p></div>
        </div>
      <div class="mt-10 bg-white p-6 rounded shadow">
      <canvas id="dashboardChart" width="500" height="200"></canvas>
    </div>
  </section>
  <section id="contatos" class="section">
    <h1>Contatos</h1>
    <ul class="list-group list-group-flush" id="contatosList"></ul>
  </section>
  <section id="consultas" class="section">
    <h1>Agendamentos de Consulta</h1>
                <ul class="list-group list-group-flush" id="agendamentosList">
                    <!-- Agendamentos ser√£o inseridos aqui -->
                </ul>
  </section>
  <section id="curriculos" class="section">
    
  </section>
  <section id="admins" class="section"><h1>Admins</h1>
    <div class="card shadow-lg p-4">
            <div class="card-body">
                <ul class="list-group list-group-flush" id="userList">
                    <!-- Itens da lista de usu√°rios ser√£o inseridos aqui dinamicamente -->
                </ul>
            </div>
        </div>
  </section>
</div>
<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>



   

  <script>
const links = document.querySelectorAll(".sidebar a");
const sections = document.querySelectorAll(".section");

links.forEach(link => {
  link.addEventListener("click", e => {
    if (link.id === "voltarsite") {
      // Deixa o link "voltar para o site" funcionar normalmente
      return;
    }

    e.preventDefault();

    const targetId = link.getAttribute("href").substring(1);

    sections.forEach(section => {
      section.classList.remove("active");
    });

    const targetSection = document.getElementById(targetId);
    if (targetSection) {
      targetSection.classList.add("active");
    }
  });
});








    function atualizarTotalConsultas() {
  fetch('http://localhost:3006/cadastro-pet') // ajuste para sua rota que retorna as consultas
    .then(res => {
      if (!res.ok) throw new Error('Erro ao buscar consultas');
      return res.json();
    })
    .then(data => {
      // Supondo que 'data' seja um array de consultas
      const total = Array.isArray(data) ? data.length : 0;
      document.getElementById('totalConsultas').textContent = total;
    })
    .catch(err => {
      console.error(err);
    });
}
// Atualiza ao carregar a p√°gina
atualizarTotalConsultas();

// Atualiza a cada 30 segundos (30000ms)
setInterval(atualizarTotalConsultas, 30000);




    function atualizarTotalusers() {
  fetch('http://localhost:3006/users')
    .then(res => {
      if (!res.ok) throw new Error('Erro ao buscar consultas');
      return res.json();
    })
    .then(data => {
      // Supondo que 'data' seja um array de consultas
      const total = Array.isArray(data) ? data.length : 0;
      document.getElementById('totalusers').textContent = total;
    })
    .catch(err => {
      console.error(err);
    });
}

atualizarTotalusers();
setInterval(atualizarTotalusers, 30000);



    function atualizarTotalcontato() {
  fetch('http://localhost:3006/contato')
    .then(res => {
      if (!res.ok) throw new Error('Erro ao buscar consultas');
      return res.json();
    })
    .then(data => {
      // Supondo que 'data' seja um array de consultas
      const total = Array.isArray(data) ? data.length : 0;
      document.getElementById('totalcontato').textContent = total;
    })
    .catch(err => {
      console.error(err);
    });
}

atualizarTotalcontato();
setInterval(atualizarTotalcontato, 30000);



  function atualizarGrafico() {
    const totalContatos = parseInt(document.getElementById('totalcontato').textContent);
    const totalConsultas = parseInt(document.getElementById('totalConsultas').textContent);
    const totalCurriculos = parseInt(document.getElementById('totalCurriculos').textContent);
    const totalAdmins = parseInt(document.getElementById('totalusers').textContent);

    const ctx = document.getElementById('dashboardChart').getContext('2d');

    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Contatos', 'Consultas', 'Curr√≠culos', 'Admins'],
        datasets: [{
          label: 'Total',
          data: [totalContatos, totalConsultas, totalCurriculos, totalAdmins],
          backgroundColor: [
            '#0d9488', '#3b82f6', '#f59e0b', '#8b5cf6'
          ]
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: true,
            precision: 0
          }
        }
      }
    });
  }

  // Aguarda os dados atualizarem antes de desenhar o gr√°fico
  window.addEventListener('load', () => {
    setTimeout(atualizarGrafico, 500); // tempo para garantir os dados em tempo real
  });





const user = JSON.parse(localStorage.getItem('usuarioLogado'));

if (user && user.username) {
  document.getElementById('welcomeMessage').innerHTML = `Ol√°, <span class="user-name">${user.username}</span>, este √© o seu painel.`;
} else {
  window.location.href = 'index.html';
}

  </script>
</body>
</html>
